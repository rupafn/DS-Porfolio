# -*- coding: utf-8 -*-
"""clustering experiment.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1Ew8zmMvtHuFGDba6rH4qRVPlGGZyYrj3
"""

#install pycaret
# !pip install pycaret
# load dataset
from pycaret.datasets import get_data
#Import required module
import pandas as pd
import numpy as np
from sklearn.decomposition import PCA
import seaborn as sns
import matplotlib.pyplot as plt
import plotly.express as px


from sklearn.cluster import KMeans

# load data
data = get_data('facebook')

data.shape

print('All of the features are very highly positively correlated')
corr = data.corr()
corr.style.background_gradient(cmap='coolwarm')

# check data type
data.dtypes

# convert categorical column to numeric using One Hot Encoding
data['status_type'].unique()

data = data.join(pd.get_dummies(data['status_type']))

# drop columns status_id, status_type and status_published for further evaluation
X = data.iloc[:, 3:]

pca = PCA(n_components=2)
df = pca.fit_transform(X)

#Initialize the class object
kmeans = KMeans(n_clusters= 8)

label = kmeans.fit_predict(X)

print(label)

df = pd.DataFrame(df)
df['label'] = label
df['status_id'] = data['status_id']

# using plt.scatter plot scatter plot clusters of the KMeans
lab0 = df[label == 0]
lab1 = df[label == 1]
lab2 = df[label == 2]
lab3 = df[label == 3]
lab4 = df[label == 4]
lab5 = df[label == 5]
lab6 = df[label == 6]
lab7 = df[label == 7]
plt.scatter(lab0[0], lab0[1], color= [1,0,0])
plt.scatter(lab1[0], lab1[1], color=[0,1,0])
plt.scatter(lab2[0], lab2[1], color=[0,0,1])
plt.scatter(lab3[0], lab3[1], color = [0.5,0.2,0.3])
plt.scatter(lab4[0], lab4[1], color = [0.7,0.2,0.6])
plt.scatter(lab5[0], lab5[1], color = [1,0.3,0.7])
plt.scatter(lab6[0], lab6[1], color = [0.9,0.313,0.865])
plt.scatter(lab7[0], lab7[1])

# use plotly to present a better looking scatter plot of the kMeans cluster groups
fig = px.scatter(df, x=0, y=1, color="label",   hover_data=['status_id'])
fig.show()

df

